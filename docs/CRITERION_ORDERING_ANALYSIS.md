# Criterion Ordering Analysis: Krylov vs Spectral Across Ensembles

**Date:** 2026-01-13
**Status:** Complete Analysis (CORRECTED: No flip exists - Krylov < Spectral is universal)

---

## 1. The Observation

### 1.1 GEO2LOCAL Results (Geometric 2-Local Lattice)

| Dimension | ρ_c (Spectral) | ρ_c (Krylov) | Ordering |
|-----------|----------------|--------------|----------|
| d=16      | 0.069          | 0.041        | **Krylov < Spectral** |
| d=32      | 0.133          | 0.022        | **Krylov < Spectral** |
| d=64      | 0.180          | 0.013        | **Krylov < Spectral** |

**Key observation:** For GEO2, Krylov criterion detects reachability at **lower** ρ than Spectral.

### 1.2 Canonical Basis Results (Sparse Pauli-like Operators)

For canonical basis with dimensions d=10-26:
- K_c (Spectral) ≈ 1.01d - 5.3
- K_c (Krylov) ≈ 0.98d - 0.3

The critical densities ρ_c = K_c/d² are **similar**, with Spectral potentially having a slight edge at detecting reachability.

### 1.3 The Core Question

**Why does Krylov "win" (lower ρ_c) in GEO2 but not in Canonical?**

---

## 2. What the Criteria Measure

### 2.1 Spectral Criterion

```
S(λ) = Σₙ |⟨n(λ)|φ⟩| |⟨n(λ)|ψ⟩|
```

- Measures **eigenbasis alignment** between initial state |ψ⟩ and target |φ⟩
- Requires the eigenstates |n(λ)⟩ of H(λ) to align with both states
- **λ-dependent**: Different λ → different eigenbasis → different overlap
- Physical meaning: "Can we find a Hamiltonian whose energy eigenstates overlap well with both initial and target?"

### 2.2 Krylov Criterion

```
R(λ) = ‖P_Kₘ |φ⟩‖²
```

where K_m = span{|ψ⟩, H(λ)|ψ⟩, ..., H(λ)^(m-1)|ψ⟩}

- Measures whether target lies in the **dynamical subspace** generated by repeated Hamiltonian action
- **Weakly λ-dependent**: The Krylov subspace depends on the direction of H, not strongly on its magnitude
- Physical meaning: "Can repeated application of H(λ) propagate |ψ⟩ toward |φ⟩?"

### 2.3 Key Distinction

| Aspect | Spectral | Krylov |
|--------|----------|--------|
| What it probes | Eigenstructure | Dynamical reachability |
| λ dependence | Strong | Weak |
| Fixed vs Optimized | Huge gap | Nearly identical |
| Sensitive to | Eigenvalue distribution | Connectivity structure |

---

## 3. The Integrability Hypothesis

### 3.1 Core Conjecture

**GEO2 is more "integrable" (structured) than Canonical, and this structure benefits Krylov propagation while hindering spectral alignment.**

### 3.2 Supporting Evidence

**GEO2 Structure:**
- Operators are geometrically 2-local (nearest-neighbor on lattice)
- L = 3n + 9|E| operators with strict locality constraints
- Conjugation symmetry: Z^y H Z^y has same distribution as H
- The arXiv paper notes: anticoncentration remains an open question (suggests non-generic spectral properties)

**Canonical Structure:**
- Operators {X_jk, Y_jk, Z_j, I} are non-local (connect any pair j,k)
- Random sampling creates effective all-to-all connectivity
- More "generic" in random matrix sense

### 3.3 Mechanism

**Why Krylov Wins in GEO2:**

1. **Geometric locality aids systematic exploration**
   - Krylov subspace K_m builds up by repeated H application
   - In local systems, this creates "light cone" spreading
   - Information propagates systematically through the lattice
   - Target states can be reached efficiently through local operations

2. **Structured eigenbasis hinders spectral optimization**
   - Local Hamiltonians have more constrained eigenstructure
   - Eigenstates may have definite spatial structure (localized, extended)
   - Harder to find λ that aligns eigenbasis with arbitrary target

**Why Spectral Catches Up (or Wins) in Canonical:**

1. **Random structure creates flexible eigenbasis**
   - Non-local operators generate more "random" eigenstructures
   - Optimization can find good alignments more easily
   - No geometric constraints on eigenbasis form

2. **Krylov propagation is less structured**
   - Without geometric locality, H^n|ψ⟩ spreads diffusively
   - No systematic "path" to target
   - May need more operators to span the relevant subspace

---

## 4. Connection to Quantum Chaos

### 4.1 Level Spacing Statistics

The **r-ratio** quantifies spectral chaos:
```
r = min(sₙ, sₙ₊₁) / max(sₙ, sₙ₊₁)
```
where sₙ = Eₙ₊₁ - Eₙ are level spacings.

| Spectrum Type | ⟨r⟩ | Physical Character |
|---------------|-----|-------------------|
| Poisson | 0.386 | Integrable, uncorrelated levels |
| GOE | 0.531 | Time-reversal symmetric chaos |
| GUE | 0.600 | No time-reversal symmetry |

### 4.2 Predictions

| Ensemble | Expected ⟨r⟩ | Criterion Ordering |
|----------|--------------|-------------------|
| GEO2 (local) | Closer to Poisson? | Krylov < Spectral |
| Canonical (non-local) | Closer to GOE/GUE? | Spectral ≤ Krylov |

### 4.3 Test Strategy

Implement well-characterized integrable vs chaotic Hamiltonians:

1. **Ising longitudinal only** (integrable)
   - H = Σ J_i σᶻᵢσᶻᵢ₊₁ + Σ h_i σᶻᵢ
   - Diagonal in Z-basis, Poisson statistics
   - Prediction: Krylov < Spectral

2. **Ising with transverse field** (near-integrable)
   - H = J Σ σᶻᵢσᶻᵢ₊₁ + h_z Σ σᶻᵢ + g Σ σˣᵢ
   - Transition as g increases
   - Prediction: Ordering transitions

3. **Random Heisenberg** (chaotic)
   - H = Σ Jˣᵢ σˣᵢσˣᵢ₊₁ + Jʸᵢ σʸᵢσʸᵢ₊₁ + Jᶻᵢ σᶻᵢσᶻᵢ₊₁
   - GOE statistics expected
   - Prediction: Spectral ≤ Krylov

---

## 5. Alternative Hypotheses

### 5.1 Sparsity Structure

**Hypothesis:** The sparsity pattern (not locality) drives the difference.

- GEO2: Sparse with structured pattern (lattice connectivity)
- Canonical: Sparse with random pattern (2 non-zeros per operator)
- GOE/GUE: Dense (all elements non-zero)

**Test:** Compare 1D chain GEO2 vs 2D lattice GEO2 (same sparsity formula, different geometry).

### 5.2 Operator Algebra

**Hypothesis:** The Lie algebra generated by operators differs.

- GEO2: su(2^n) generated by local operators → restricted controllability
- Canonical: su(d) generated by sparse but non-local operators

**Test:** Compute the dynamical Lie algebra dimension for small systems.

### 5.3 Basis Completeness

**Hypothesis:** How quickly the basis operators span the full Hilbert space.

- GEO2: L = 3n + 9|E| ~ 21n (linear in qubits, exponentially smaller than d²)
- Canonical: d² operators available (complete basis)

**Test:** Plot criterion ordering vs (basis size / d²) ratio.

---

## 6. Experimental Plan

### 6.1 Immediate (scripts/integrability/criterion_vs_chaos.py)

Run on d=16 (4 qubits):
1. Generate integrable, near-integrable, chaotic Hamiltonians
2. Compute ⟨r⟩ for each ensemble
3. Run Spectral and Krylov criteria
4. Compare ρ_c ordering

**Expected runtime:** ~1 hour for quick test, ~10 hours for production quality.

### 6.2 Follow-up Experiments

If integrability hypothesis is confirmed:

1. **Vary GEO2 geometry**: 1D chain vs 2D square vs triangular
2. **Interpolate ensembles**: α × Canonical + (1-α) × GEO2
3. **Track ordering transition**: Plot ρ_c(Krylov) - ρ_c(Spectral) vs ⟨r⟩

If integrability hypothesis fails:

1. **Focus on sparsity**: Test dense local Hamiltonians
2. **Test operator algebra**: Compute dynamical Lie algebra dimension
3. **Check basis completeness**: K/L vs K/d² analysis

---

## 7. Implications

### 7.1 For Quantum Control

If the integrability connection is confirmed:
- **Near-integrable systems**: Use Krylov-based control protocols
- **Chaotic systems**: Spectral optimization may be more effective
- **Practical guidance**: Choose criterion based on system structure

### 7.2 For Quantum Advantage

From arXiv:2510.06321:
- GEO2 enables quantum advantage with minimal overhead
- Our finding suggests: The same local structure that enables advantage also affects controllability
- **Interpretation**: Locality is a double-edged sword for quantum computing

### 7.3 For Fundamental Physics

- Connection between chaos/integrability and controllability
- Spectral rigidity (integrable) vs flexibility (chaotic)
- Dynamical reachability vs static eigenstructure alignment

---

## 8. Open Questions

1. **Quantitative relationship**: Can we predict ρ_c(Krylov)/ρ_c(Spectral) from ⟨r⟩?

2. **Universality**: Does the ordering flip occur at a specific ⟨r⟩ value?

3. **Finite-size scaling**: How does the ordering depend on system size n?

4. **Beyond r-ratio**: Are there better chaos indicators for this problem?

5. **Connection to ETH**: Does eigenstate thermalization affect criterion behavior?

---

## 9. Experimental Results (2026-01-13)

### 9.1 Integrability Test (Level Spacing Statistics)

Tested with n=4 qubits (d=16), 100 random samples each:

| Model | ⟨r⟩ | Classification |
|-------|-----|----------------|
| Integrable Ising (Z-Z + Z) | 0.373 ± 0.099 | Poisson |
| Near-integrable (g=0.1) | 0.074 ± 0.055 | Sub-Poisson* |
| Near-integrable (g=0.5) | 0.226 ± 0.078 | Poisson |
| Chaotic Heisenberg | 0.557 ± 0.081 | GOE |

*Sub-Poisson r-values indicate symmetry-related level clustering.

**Reference:** Poisson ⟨r⟩ ≈ 0.386, GOE ⟨r⟩ ≈ 0.531

### 9.2 Connectivity Test Results

Tested chain (3 edges) vs complete graph (6 edges) with same Pauli basis structure:

| Connectivity | L (operators) | ρ_c(Spectral) | ρ_c(Krylov) | Ordering |
|--------------|---------------|---------------|-------------|----------|
| Chain | 39 | 0.066 | 0.045 | **Krylov < Spectral** |
| Complete | 66 | 0.060 | 0.045 | **Krylov < Spectral** |

**KEY FINDING:** Both connectivities show GEO2-like ordering!

This suggests connectivity constraint is NOT the primary factor causing the ordering difference.

### 9.3 Normalization Test (K/L vs K/d²)

GEO2 d=16 (L=48):
- K/d² normalization: ρ_c(S) = 0.069, ρ_c(K) = 0.041
- K/L normalization: ρ_c(S) = 0.370, ρ_c(K) = 0.218

**KEY FINDING:** Krylov < Spectral ordering persists regardless of normalization.

### 9.4 Revised Hypothesis

Given that connectivity and normalization don't explain the difference, the remaining hypotheses are:

1. **Operator sparsity pattern** - Not just connectivity, but the specific structure of sparse matrices
2. **Operator sampling method** - GEO2 samples from fixed basis, Canonical samples randomly
3. **λ-optimization effectiveness** - Different optimization landscapes

### 9.5 CRITICAL FINDING: No Ordering Flip!

**Re-analysis of actual data reveals both ensembles show the SAME ordering:**

| Ensemble | d | K_c (Spectral) | K_c (Krylov) | Ordering |
|----------|---|----------------|--------------|----------|
| GEO2 | 16 | 18 (ρ=0.070) | 13 (ρ=0.051) | **Krylov < Spectral** |
| Canonical | 26 | 40 (ρ=0.059) | 25 (ρ=0.037) | **Krylov < Spectral** |

**Both ensembles show Krylov detects reachability at lower K than Spectral!**

The original premise of a "flipped ordering" appears to be incorrect. The data consistently shows:
- **Krylov ρ_c < Spectral ρ_c** for both GEO2 and Canonical
- The difference is the **magnitude** of ρ_c, not the ordering

### 9.6 Revised Research Question

Instead of "Why does the ordering flip?", the question should be:
**"Why is ρ_c(Spectral)/ρ_c(Krylov) ratio different between ensembles?"**

| Ensemble | ρ_c(S)/ρ_c(K) | Interpretation |
|----------|---------------|----------------|
| GEO2 d=16 | 1.38 | Spectral requires 38% more K than Krylov |
| Canonical d=26 | 1.60 | Spectral requires 60% more K than Krylov |

The ratio is LARGER for Canonical, meaning the gap between criteria is bigger for Canonical.

### 9.7 Possible Explanations for Ratio Difference

1. **Dimension scaling**: ρ_c(S)/ρ_c(K) may depend on d
2. **Basis structure**: Different operator structures affect optimization landscape
3. **λ-independence of Krylov**: Krylov is nearly λ-independent (GEO2 observation), affects ratio

---

## References

1. arXiv:2510.06321 - GEO2 ensemble definition
2. `reach/models.py:206-376` - GeometricTwoLocal implementation
3. `reach/mathematics.py:372-618` - Krylov and spectral criterion functions
4. `docs/GEO2_DOCUMENTATION.md` - GEO2 analysis summary
5. `scripts/integrability/criterion_vs_chaos.py` - Integrability experiment
6. `scripts/integrability/connectivity_test.py` - Connectivity hypothesis test
7. `scripts/integrability/normalization_check.py` - Normalization analysis

---

## Appendix: Key Equations

### Spectral Overlap
```
S(λ) = Σₙ |⟨n(λ)|φ⟩| |⟨n(λ)|ψ⟩|

where H(λ)|n(λ)⟩ = Eₙ(λ)|n(λ)⟩
```

### Krylov Score
```
R(λ) = ‖P_Kₘ |φ⟩‖² = Σₙ₌₀^(m-1) |⟨Kₙ(λ)|φ⟩|²

where K_m(H, |ψ⟩) = span{|ψ⟩, H|ψ⟩, ..., H^(m-1)|ψ⟩}
```

### Level Spacing r-ratio
```
rₙ = min(sₙ, sₙ₊₁) / max(sₙ, sₙ₊₁)

where sₙ = Eₙ₊₁ - Eₙ
```

### GEO2 Operator Count
```
L = 3n + 9|E|

where n = sites, |E| = edges
```

---

## 10. Phase 3 Final Results (2026-01-13)

### 10.1 Dimension Dependence Analysis

**Key Finding: The ratio ρ_c(Spectral)/ρ_c(Krylov) scales differently between ensembles.**

| Ensemble | d | ρ_c(S) | ρ_c(K) | Ratio |
|----------|---|--------|--------|-------|
| **GEO2** | 16 | 0.069 | 0.041 | 1.70 |
| **GEO2** | 32 | 0.133 | 0.022 | 5.97 |
| **GEO2** | 64 | 0.180 | 0.013 | 13.38 |
| **Canonical** | 10 | 0.142 | 0.091 | 1.56 |
| **Canonical** | 14 | 0.108 | 0.067 | 1.62 |
| **Canonical** | 18 | 0.088 | 0.052 | 1.70 |
| **Canonical** | 22 | 0.075 | 0.044 | 1.73 |
| **Canonical** | 26 | 0.066 | 0.037 | 1.80 |

**Observations:**
- GEO2: Ratio increases **dramatically** with d (1.7 → 13)
- GEO2: Krylov ρ_c DECREASES with d, Spectral INCREASES
- Canonical: Ratio stays relatively **stable** (~1.5-1.8)
- Canonical: Both ρ_c decrease with d, Krylov decreases faster

### 10.2 Fixed vs Optimized λ Gap Analysis

| d | Spectral Gap | Krylov Gap | Interpretation |
|---|-------------|-----------|----------------|
| 16 | 0.540 ± 0.363 | 0.141 ± 0.318 | Spectral benefits 4x more |
| 32 | 0.201 ± 0.142 | 0.066 ± 0.200 | Spectral benefits 3x more |
| 64 | 0.024 ± 0.020 | 0.003 ± 0.009 | Both nearly λ-independent |

**Key Findings:**
- Gap = P(unreachable|Fixed) - P(unreachable|Optimized)
- Spectral always has larger gap than Krylov
- **Both gaps decrease with dimension** - both become λ-independent at high d
- Krylov's λ-independence is more pronounced at all dimensions

### 10.3 Integrability Study Results

**Level Spacing Statistics (r-ratio):**
| Model | ⟨r⟩ | Classification |
|-------|-----|----------------|
| Integrable Ising (Z-Z + Z) | 0.378 | Poisson |
| Near-integrable (g=0.1) | 0.065 | Sub-Poisson |
| Near-integrable (g=0.5) | 0.185 | Poisson |
| Chaotic Heisenberg | 0.549 | GOE |

**Criterion Ordering by Model:**
| Model | ρ_c(Spectral) | ρ_c(Krylov) | Ordering |
|-------|---------------|-------------|----------|
| Integrable | N/A (always 1.0) | 0.052 | **Krylov only** |
| Near-integrable | N/A (always 1.0) | 0.057 | **Krylov only** |
| Chaotic | 0.068 | 0.042 | **Krylov < Spectral** |

**Critical Finding:**
- For **integrable** models, Spectral NEVER detects reachability (P=1.0 for all K)
- This is because diagonal Hamiltonians have fixed eigenbasis → no λ-optimization possible
- For **chaotic** models, both criteria show transitions with ratio ≈ 1.6

### 10.4 Summary of Key Findings

1. **Universal Ordering**: Krylov < Spectral for ALL tested ensembles
   - GEO2, Canonical, Integrable (where Spectral works), Chaotic

2. **Ratio Scaling**:
   - GEO2: Ratio grows dramatically with d (structural effect)
   - Canonical: Ratio stays stable (~1.6)

3. **λ-Independence**:
   - Krylov is nearly λ-independent (subspace geometry depends on H direction, not scale)
   - Spectral benefits from optimization but gap decreases at high d

4. **Integrability Effect**:
   - Integrable (diagonal) systems: Spectral criterion fails completely
   - Chaotic systems: Both criteria work, maintaining Krylov < Spectral ordering

### 10.5 Revised Conclusions

The original hypothesis of a "criterion ordering flip" was **incorrect**.

**Correct statement**: Krylov consistently detects reachability at lower operator density than Spectral across all tested ensembles. The difference between ensembles is:

- **GEO2**: Large and growing ratio (structural/locality effects)
- **Canonical**: Stable ratio (~1.6)
- **Integrable**: Infinite ratio (Spectral fails)
- **Chaotic**: Finite ratio (~1.6)

**Physical Interpretation**:
- Krylov probes dynamical reachability (subspace spanning)
- Spectral probes static eigenbasis alignment
- Dynamical reachability is a "weaker" requirement → Krylov always wins

---

## Generated Figures

All analysis figures saved to `fig/analysis/`:
- `dimension_dependence_comparison.png` - ρ_c vs d for both ensembles
- `unified_qubit_comparison.png` - Unified qubit-based comparison
- `fixed_vs_optimized_gap.png` - λ-optimization gap analysis
- `gap_scaling_summary.png` - Gap scaling with dimension
- `criterion_ordering_summary.png` - Publication-quality summary figure

Integrability figures saved to `fig/integrability/`:
- `criterion_vs_chaos_comparison.png` - Integrability study results

---

**End of Analysis Document**
